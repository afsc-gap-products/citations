---
output: 
  md_document: 
    variant: gfm
csl: "https://raw.githubusercontent.com/citation-style-language/styles/master/apa-no-ampersand.csl"
bibliography: "./cite/bibliography.bib"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warnings = FALSE, error = FALSE, message = FALSE, comment = FALSE)
link_repo <- "https://github.com/afsc-gap-products/citations"
```

<!-- README.md is generated from README.Rmd. Please edit that file -->

# [AFSC RACE GAP Citations Resource](`r link_repo`) <img src="https://avatars.githubusercontent.com/u/91760178?s=96&amp;v=4" alt="Logo." align="right" width="139" height="139"/>

The scripts therein reproducibly produce our citations for our data, annual data reports, presentations, and other outreach documents.  

> This code is always in development. Find code used for various reports in the code [releases](paste0(`r link_repo`, "/releases")).

## This code is primarally maintained by:

**Emily Markowitz** (Emily.Markowitz AT noaa.gov; [\@EmilyMarkowitz-NOAA](https://github.com/EmilyMarkowitz-NOAA))

**Megsie Siple** (Margaret.Siple AT noaa.gov; [\@MargaretSiple-NOAA](https://github.com/MargaretSiple-NOAA))

**Liz Dawson** (Liz.Dawson AT noaa.gov; [\@liz-dawson-NOAA](https://github.com/liz-dawson-NOAA))

**Alex Dowlin** (Alexandra.Dowlin AT noaa.gov; [\@AlexandraDowlin-NOAA](https://github.com/AlexandraDowlin-NOAA))

**Chris Anderson** (Christopher.Anderson AT noaa.gov; [\@ChrisAnderson-NOAA](https://github.com/ChrisAnderson-NOAA))

**Bethany Riggle** (Bethany.Riggle AT noaa.gov; [\@bethanyriggle](https://github.com/bethanyriggle))

Alaska Fisheries Science Center,

National Marine Fisheries Service,

National Oceanic and Atmospheric Administration,

Seattle, WA 98195

# Table of contents

```{r toc, echo = FALSE, eval = TRUE, warning=FALSE}
toc <- strsplit(x = readtext::readtext(file = "./README.Rmd")[[2]], split = "\n")
toc <- toc[[1]][substr(x = toc[[1]], start = 1, stop = 1) == "#"]
toc <- toc[-c(1:3)]
toc_list <- toc
toc_list <- gsub(pattern = "### ", replacement = ">      - [*", x = toc_list, fixed = TRUE)
toc_list <- gsub(pattern = "## ", replacement = ">    - [*", x = toc_list, fixed = TRUE)
toc_list <- gsub(pattern = "# ", replacement = ">  - [*", x = toc_list, fixed = TRUE)
toc_link <- tolower(gsub(pattern = " ", replacement = "-", 
                          x = gsub(pattern = "#", replacement = "", 
                                   x = gsub(pattern = "# ", replacement = "", 
                                            x = toc, fixed = TRUE), fixed = TRUE)))
toc <- paste0(toc_list, "*](#", toc_link, ")", collapse = "\n")
```

`r toc`

# Citation style guides

The NOAA Library now recommends that we use [American Psychological Association 7th edition (no ampersand)](https://www.zotero.org/styles/apa-no-ampersand) for citing in NOAA technical memorandums and other NOAA process report publications. Learn more about APA 7th from this [Purdue Owl](https://owl.purdue.edu/owl/research_and_citation/apa_style/apa_formatting_and_style_guide/reference_list_author_authors.html) resoure.

![APA 7th no Ampersand](./img/apa7.png)

The citation style guide for APA 7th can be downloaded from [github](https://github.com/citation-style-language/styles). This independent open source Citation Style Language (CSL) project aims to facilitate scholarly communication by automating the formatting of citations and bibliographies. 

# How to cite

Add the link to the [`.bib`](https://github.com/afsc-gap-products/citations/blob/main/cite/bibliography.bib) and [`.csl`](https://raw.githubusercontent.com/citation-style-language/styles/master/apa-no-ampersand.csl) files in the YAML of your `rmarkdown` ro `quarto` file like so:

## As local files

Note that "../" before the file names refers to directory navigation. 

```{r, eval = FALSE, echo = TRUE}
---
title: "untitled"
date: "`r paste0(format(Sys.time(), '%B %d, %Y'))`"
output: html_document
csl: "../cite/citestyle.csl"
bibliography: "../cite/bibliography.bib"
---

```

To download the CSL and save it to your project, you can use the following code:

```{r, eval = FALSE, echo = TRUE}
csl <- readLines("https://raw.githubusercontent.com/citation-style-language/styles/master/apa-no-ampersand.csl")
readr::write_lines(x = csl, file = "./cite/citestyle.csl")

bib <- readLines("https://github.com/afsc-gap-products/citations/blob/main/cite/bibliography.bib")
readr::write_lines(x = bib, file = "./cite/bibliography.csl")
```

## Sourcing directly from github

Sourcing directly from github requires internet access, but ensures that you will always have the most up to date citation style library and bibliography references. 

```{r, eval = FALSE, echo = TRUE}
---
title: "untitled"
date: "`r paste0(format(Sys.time(), '%B %d, %Y'))`"
output: html_document
csl: "https://raw.githubusercontent.com/citation-style-language/styles/master/apa-no-ampersand.csl"
bibliography: "https://github.com/afsc-gap-products/citations/blob/main/cite/bibliography.bib"
---

```

# Citation files in action

Use the `[@...]` notation in your `rmarkdown` or `quarto` call a reference number for a citation. 

```{r, eval = FALSE, echo = TRUE}
For example, here are **Annual Bering Sea Data Report** [@2022NEBS2022; @2021NEBS2022; @2019NEBS2022; @2018EBS2022]
```

*Which renders as:*

For example, here are **Annual Bering Sea Data Report** [@2022NEBS2022; @2021NEBS2022; @2019NEBS2022; @2018EBS2022]

Naturally, without writing anything else, references will appear at the of the document. If you want them to render at a specific place in your document, call the code below: 

```{r, eval = FALSE, echo = TRUE}
<div id="refs"></div>
```

*Which renders as:*

<div id="refs"></div>


# Contribute to this repo and community `.bib` file

This repository is meant to act as a resource for all members of GAP and beyond. Do you see that a citation is missing from our `.bib` file or you have a new publication? Please add it by submitting a [pull request](`r paste0(link_repo, "/pulls")`) or speaking to one of the repository maintainers. 

## Bibliography syntax notes

### Finding pre-formatted citations

While not perfect, the below resources can use DOIs or other paper identifiers to find and construct bibliographies in the right format for you:

 - https://www.doi2bib.org/
 - https://zbib.org/

### Forced case-sensitivity

Use `{...}` to force capitalization. This may be needed for proper nouns. 

```{r, eval = FALSE, echo = TRUE}
...
   title = {Results of the 2021 eastern and northern {Bering Sea} continental shelf bottom trawl survey of groundfish and invertebrate fauna},
...
```

### listing DOIs

While the whole link for a DOI may be https://doi.org/10.25923/9c3r-xp53, only list the text after the "https://doi.org/" in the `.bib` file. 

```{r, eval = FALSE, echo = TRUE}
...
  doi = {10.25923/9C3R-XP53},
...
```

### Use Journal abbreviations

Journal abbreviations can be found through the [Web of Science](https://images.webofknowledge.com/images/help/WOS/A_abrvjt.html) for any given scientific journal.

```{r, eval = FALSE, echo = TRUE}
...
  journal = {Fish. Oceanogr.},
...
```


## Bibliography examples

To make sure all bibliography listed in the `.bib` file are consistent, please refer to these common bibliography types and examples: 

### NOAA technical memorandums/process reports

```{r, eval = FALSE, echo=TRUE}
@article{RN888,
   author = {Alton, M. S. and Bakkala, R. G. and Walters G. E. and Munro, P. T.},
   title = {Greenland turbot {(\emph{Reinhardtius hippoglossoides})} of the eastern {Bering Sea} and {Aleutian Islands} region},
   url = {https://spo.nmfs.noaa.gov/content/tr-71-greenland-turbot-reinhardtius-hippoglossoides-eastern-bering-sea-and-aleutian-islands},
   year = {1998},
   publisher = {{U.S. Dep. Commer.}},
   type = {NOAA Tech. Rep.}, 
   number = {NMFS-71}
}

@article{2021NEBS2022,
   author = {Markowitz, E. H. and Dawson, E. J. and Charriere, N. E. and Prohaska, B. K. and Rohan, S. K.  and Stevenson, D. E. and Britt, L. L.},
   title = {Results of the 2021 eastern and northern {Bering Sea} continental shelf bottom trawl survey of groundfish and invertebrate fauna},
   publisher = {{U.S. Dep. Commer.}},
   year = {2022},
   type = {NOAA Tech. Memo.},
   copyright = {Public domain}
}

@article{RN920,
   author = {Pereyra, W. T. and Reeves, J. E. and Bakkala, R. G.},
   title = {Demersal fish and shellfish resources of the eastern {Bering Sea} in the baseline year 1975},
   publisher = {U.S. Dep. Commer.},
   type = {NOAA Processed Rep.},
   year = {1976},
   copyright = {Public domain}
}
```

### NOAA Stock Assessments

```{r, eval = FALSE, echo=TRUE}
@inproceedings{RN921,
   author = {Rose, C. S. and Walters, G. E.},
   title = {Trawl width variation during bottom trawl surveys: causes and consequences},
   booktitle = {Proceedings of the symposium on application of stock assessment techniques applies to gadids},
   publisher = {International Northern {Pacific} Fisheries Communication Bulletin},
   volume = {50},
   pages = {p. 57-67},
   year = {1990},
   type = {Conference Proceedings}
}

@article{McGilliardetal2018,
   author = {McGilliard, C. R. and Nichol, D. G. and Palsson, W. A.},
   title = {Assessment of the flathead sole-Bering flounder stock in the {Bering Sea} and {Aleutian Islands}},
    booktitle = {Stock assessment and fishery evaluation report for the groundfish resources of the {Bering Sea}/{Aleutian Islands} regions},
   institution = {North Pacific Fishery Management Council},
   address = {605 W. 4th Ave., Anchorage, AK 99501},
   year = {2018}
}
```

### Journal articles 

```{r, eval = FALSE, echo=TRUE}
@article{RN929,
   author = {Spencer, P. D.},
   title = {Density‐independent and density‐dependent factors affecting temporal changes in spatial distributions of eastern {Bering Sea} flatfish},
  doi = {10.1111/j.1365-2419.2008.00486.x},
  journal = {Fish. Oceanogr.},
  publisher = {Wiley},
   volume = {17},
   number = {5},
   pages = {p. 396-410},
   ISSN = {1054-6006},
   year = {2008}
}
```

### Presentations

> Example coming soon!

### Data

> Example coming soon! (e.g., FOSS)

### Citing in-house built R packages

For packages not on CRAN, package builders can use [Zenodo](https://docs.github.com/en/repositories/archiving-a-github-repository/referencing-and-citing-content) to cite their R packages. 

> Example coming soon! (e.g., {coldpool})

### Legislation

> Example coming soon! (e.g., Magnuson-Stevenson)

### Web pages

> Example coming soon! (e.g., NOAA Fisheries' website)

### Books

```{r, eval = FALSE, echo=TRUE}
@book{RN912,
   author = {Mecklenburg, C. W. and Mecklenburg, T. A. and Thorsteinson, L. K.},
   title = {Fishes of {Alaska}},
   ISBN = {1888569077},
   year = {2002}
}
```

# Cite all R packages on a computer or used in a project

Here is how the user can find all of the packages ever installed on the local computer

```{r, eval = TRUE, echo = TRUE}
PKG <- tibble::tibble(
  Package = names(installed.packages()[,3]),
  Version = unname(installed.packages()[,3])
)
head(PKG)
```

Here is how the user can find all of the packages ever installed on the local computer

```{r, eval = TRUE, echo = TRUE}
PKG <- names(sessionInfo()[7][[1]])
PKG
```

Then to cite the packages loaded for this R project, create a .bib file for R packages:

```{r, echo = TRUE, eval = TRUE}
knitr::write_bib(x = PKG,
                 file = "./cite/bibliography_RPack.bib")
```

*Which looks like*

```{r, eval = TRUE, echo = FALSE}
readLines(con = "./cite/bibliography_RPack.bib", n = 8)
```
And add your new bibliography file to your YAML:

```{r, eval = FALSE, echo = TRUE}
---
title: "untitled"
date: "`r paste0(format(Sys.time(), '%B %d, %Y'))`"
output: html_document
csl: "https://raw.githubusercontent.com/citation-style-language/styles/master/apa-no-ampersand.csl"
bibliography: "../cite/bibliography_RPack.bib"
---

```

# Suggestions and Comments

If you see that the data, product, or metadata can be improved, you are invited to create a 
[pull request](`r paste0(link_repo, "/pulls")`), 
[submit an issue to the GitHub organization](`r "https://github.com/afsc-gap-products/data-requests/issues"`), or 
[submit an issue to the code's repository](`r paste0(link_repo, "/issues")`).

# R Version Metadata

```{r}
sessionInfo()
```

## NOAA README

This repository is a scientific product and is not official communication of the National Oceanic and Atmospheric Administration, or the United States Department of Commerce. All NOAA GitHub project code is provided on an ‘as is’ basis and the user assumes responsibility for its use. Any claims against the Department of Commerce or Department of Commerce bureaus stemming from the use of this GitHub project will be governed by all applicable Federal law. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement, recommendation or favoring by the Department of Commerce. The Department of Commerce seal and logo, or the seal and logo of a DOC bureau, shall not be used in any manner to imply endorsement of any commercial product or activity by DOC or the United States Government.

## NOAA License

Software code created by U.S. Government employees is not subject to copyright in the United States (17 U.S.C. §105). The United States/Department of Commerce reserve all rights to seek and obtain copyright protection in countries other than the United States for Software authored in its entirety by the Department of Commerce. To this end, the Department of Commerce hereby grants to Recipient a royalty-free, nonexclusive license to use, copy, and create derivative works of the Software outside of the United States.

<img src="https://raw.githubusercontent.com/nmfs-general-modeling-tools/nmfspalette/main/man/figures/noaa-fisheries-rgb-2line-horizontal-small.png" alt="NOAA Fisheries" height="75"/>

[U.S. Department of Commerce](https://www.commerce.gov/) \| [National Oceanographic and Atmospheric Administration](https://www.noaa.gov) \| [NOAA Fisheries](https://www.fisheries.noaa.gov/)
